# 代码回放功能使用指南

## 功能概述

代码回放页面 (`/code-replay`) 是一个专门用于播放代码编写过程的工具，可以将记录的操作数据重新演示，展现完整的编程过程。

## 页面访问方式

1. **直接访问**: 浏览器地址栏输入 `/code-replay`
2. **从编辑器跳转**: 在代码编辑器设置中点击"打开回放页面"按钮

## 主要功能

### 1. 数据导入
- **支持格式**: 
  - ACWing 挑战模式格式 (数组格式)
  - 数据库记录格式 (对象格式)
- **导入方式**: 
  - 手动粘贴数据到文本框
  - 点击"加载示例数据"查看演示效果

### 2. 播放控制
- **播放/暂停**: 控制回放的开始和停止
- **重置**: 回到开始状态，清空编辑器
- **单步执行**: 逐步查看每个操作
- **速度控制**: 0.25x ~ 8x 倍速播放

### 3. 进度显示
- **进度条**: 显示当前播放进度
- **时间信息**: 当前时间 / 总时长
- **操作计数**: 当前步骤 / 总步骤数

### 4. 实时反馈
- **代码编辑器**: 实时显示代码变化过程
- **光标指示器**: 蓝色竖线显示当前光标位置
- **当前操作**: 显示正在执行的操作详情
- **操作列表**: 显示所有操作的时间线

## 支持的操作类型

| 操作类型 | 说明 | 显示颜色 |
|----------|------|----------|
| 插入 | 字符/文本插入 | 绿色 |
| 删除 | 字符/文本删除 | 红色 |
| 移动 | 光标位置移动 | 蓝色 |
| 粘贴 | 粘贴操作 | 紫色 |
| 撤销 | Ctrl+Z 撤销 | 黄色 |
| 重做 | Ctrl+Y 重做 | 靛蓝色 |
| 清空 | 清空编辑器 | 灰色 |

## 数据格式说明

### ACWing 格式示例
```javascript
[
  [0, 0, 0, "#", 203],        // 插入字符 # 在 (0,0) 位置，时间戳 203ms
  [0, 0, 1, "i", 311],        // 插入字符 i 在 (0,1) 位置，时间戳 311ms
  [1, 0, 5, 0, 6, 2000],      // 删除 (0,5) 到 (0,6) 的内容，时间戳 2000ms
  [2, 0, 5, 1, 0, 2500]       // 光标从 (0,5) 移动到 (1,0)，时间戳 2500ms
]
```

### 数据库格式示例
```javascript
[
  {
    "type": 0,
    "old_row": null,
    "old_col": null,
    "new_row": 0,
    "new_col": 0,
    "content": "#",
    "timestamp": 203
  },
  {
    "type": 1,
    "old_row": 0,
    "old_col": 5,
    "new_row": 0,
    "new_col": 6,
    "content": "i",
    "timestamp": 2000
  }
]
```

## 使用场景

1. **编程教学**: 展示完整的代码编写过程
2. **代码审查**: 回顾编程思路和修改过程
3. **学习分析**: 分析编程习惯和效率
4. **竞赛回放**: 重现编程竞赛的解题过程
5. **错误分析**: 查看错误产生和修正的过程

## 操作技巧

### 快速导入测试数据
1. 点击"加载示例数据"
2. 点击"导入记录"
3. 点击"播放"开始观看

### 精确控制
1. 使用"单步"按钮逐步查看每个操作
2. 调整播放速度以适合观看需求
3. 通过操作列表点击跳转到特定步骤

### 数据分析
1. 观察"当前操作"面板了解操作详情
2. 查看进度条了解编程节奏
3. 通过操作列表统计各类操作的频率

## 技术特性

- **响应式设计**: 适配不同屏幕尺寸
- **实时渲染**: 流畅的代码变化动画
- **性能优化**: 支持大量操作记录的播放
- **错误处理**: 完善的数据格式验证
- **可访问性**: 键盘快捷键支持 (开发中)

## 常见问题

### Q: 导入数据失败怎么办？
A: 检查数据格式是否正确，确保是有效的 JSON 格式，并符合 ACWing 或数据库格式规范。

### Q: 播放过程中卡顿怎么办？
A: 尝试降低播放速度，或使用单步模式逐步查看。

### Q: 如何保存回放视频？
A: 可以使用浏览器的录屏功能或第三方录屏软件录制播放过程。

### Q: 支持哪些编程语言？
A: 目前主要支持 C/C++，未来会扩展到其他语言。

## 更新计划

- [ ] 添加键盘快捷键支持
- [ ] 支持更多编程语言高亮
- [ ] 添加回放视频导出功能
- [ ] 支持多用户同时观看
- [ ] 添加回放评论功能
- [ ] 优化大数据量播放性能

---

**提示**: 这个工具特别适合用于编程教学和代码分析，通过观看完整的编程过程，可以更好地理解编程思路和技巧。